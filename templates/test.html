<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<div id="container"></div>
<div id="container2"></div>

<style>
  .highcharts-figure,
  .highcharts-data-table table {
    min-width: 320px;
    max-width: 1060px;
    /* margin: 1em auto; */
  }

  .highcharts-data-table table {
    font-family: Verdana, sans-serif;
    border-collapse: collapse;
    border: 1px solid #ebebeb;
    margin: 10px auto;
    text-align: center;
    width: 100%;
    max-width: 500px;
  }
  .highcharts-data-table caption {
    padding: 1em 0;
    font-size: 1.2em;
    color: #555;
  }
  .highcharts-data-table th {
    font-weight: 600;
    padding: 0.5em;
  }
  .highcharts-data-table td,
  .highcharts-data-table th,
  .highcharts-data-table caption {
    padding: 0.5em;
  }
  .highcharts-data-table thead tr,
  .highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
  }
  .highcharts-data-table tr:hover {
    background: #f1f7ff;
  }
  .highcharts-legend-item:first-child rect {
    display: none;
  }
</style>

<script>
  var data = JSON.parse('{{ datagraph|tojson }}');
  arr = [];

  for (var i = 0; i < data.data_tonality_hub_neg_name.length; i++) {
    var obj = {};
    obj['name'] = data.data_tonality_hub_neg_name[i];
    obj['y'] = data.data_tonality_hub_neg_data[i];
    arr.push(obj);
  }
  // Build the chart
  Highcharts.chart('container', {
    chart: {
      plotBackgroundColor: null,
      plotBorderWidth: null,
      plotShadow: false,
      type: 'pie',
    },
    title: {
      text: 'New Opportunities Created',
    },
    plotOptions: {
      pie: {
        allowPointSelect: true,
        cursor: 'pointer',
        dataLabels: {
          enabled: false,
        },
        showInLegend: true,
      },
    },
    legend: {
      layout: 'vertical',
      verticalAlign: 'middle',
      align: 'right',
      symbolRadius: 2,
      useHTML: true,
      labelFormatter: function () {
        if (this.name === 'DESTINATION') {
          return `<span style="min-width: 250px; display:inline-block; border-bottom: 1px solid #b2b2b2;"><span style="float:left;">${this.name}</span><span style="float:right">COUNT</span></span>`;
        }
        return `<span style="min-width: 250px; display:inline-block; border-bottom: 1px solid #ccc;"><span style="float:left; font-size:14px; font-weight:normal" >${this.name}</span><span style="float:right">${this.y}</span></span>`;
      },
    },
    series: [
      {
        data: [
          {
            name: 'DESTINATION',
            y: null,
          },
        ],
      },
      {
        name: 'Destination',
        colorByPoint: true,
        data: arr,
      },
    ],
  });

  var data = JSON.parse('{{ datagraph|tojson }}');
  arr = [];

  for (var i = 0; i < data.data_tonality_hub_pos_name.length; i++) {
    var obj = {};
    obj['name'] = data.data_tonality_hub_pos_name[i];
    obj['y'] = data.data_tonality_hub_pos_data[i];
    arr.push(obj);
  }
  // Build the chart
  Highcharts.chart('container2', {
    chart: {
      plotBackgroundColor: null,
      plotBorderWidth: null,
      plotShadow: false,
      type: 'pie',
    },
    title: {
      text: 'New Opportunities Created',
    },
    plotOptions: {
      pie: {
        allowPointSelect: true,
        cursor: 'pointer',
        dataLabels: {
          enabled: false,
        },
        showInLegend: true,
      },
    },
    legend: {
      layout: 'vertical',
      verticalAlign: 'middle',
      align: 'right',
      symbolRadius: 2,
      useHTML: true,
      labelFormatter: function () {
        if (this.name === 'DESTINATION') {
          return `<span style="min-width: 250px; display:inline-block; border-bottom: 1px solid #b2b2b2;"><span style="float:left;">${this.name}</span><span style="float:right">COUNT</span></span>`;
        }
        return `<span style="min-width: 250px; display:inline-block; border-bottom: 1px solid #ccc;"><span style="float:left; font-size:14px; font-weight:normal" >${this.name}</span><span style="float:right">${this.y}</span></span>`;
      },
    },
    series: [
      {
        data: [
          {
            name: 'DESTINATION',
            y: null,
          },
        ],
      },
      {
        name: 'Destination',
        colorByPoint: true,
        data: arr,
      },
    ],
  });
</script>
